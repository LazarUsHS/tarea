class Nodo:
    def __init__(self, valor):
        self.valor = valor
        self.izquierda = None
        self.derecha = None

    def es_hoja(self):
        return self.izquierda is None and self.derecha is None

class ArbolBinario: 
    def __init__(self):
        self.raiz = None
    
    def insertar(self, valor):
        if self.raiz is None:
            self.raiz = Nodo(valor)
        else:
            self._insertar_recursivo(self.raiz, valor)
    
    def _insertar_recursivo(self, nodo, valor):
        if valor < nodo.valor:
            if nodo.izquierda is None:
                nodo.izquierda = Nodo(valor)
            else:
                self._insertar_recursivo(nodo.izquierda, valor)
        else:
            if nodo.derecha is None:
                nodo.derecha = Nodo(valor)
            else:
                self._insertar_recursivo(nodo.derecha, valor)
    
    def buscar(self, valor):
        return self._buscar_recursivo(self.raiz, valor)
    
    def _buscar_recursivo(self, nodo, valor):
        if nodo is None:
            return False
        if nodo.valor == valor:
            return True
        if valor < nodo.valor:
            return self._buscar_recursivo(nodo.izquierda, valor)
        return self._buscar_recursivo(nodo.derecha, valor)
    
    def altura(self):
        return self._altura_recursiva(self.raiz)
    
    def _altura_recursiva(self, nodo):
        if nodo is None:
            return -1
        return 1 + max(self._altura_recursiva(nodo.izquierda), self._altura_recursiva(nodo.derecha))
    
    def cantidad(self):
        return self._cantidad_recursiva(self.raiz)
    
    def _cantidad_recursiva(self, nodo):
        if nodo is None:
            return 0
        return 1 + self._cantidad_recursiva(nodo.izquierda) + self._cantidad_recursiva(nodo.derecha)
    
    def amplitud(self):
        if self.raiz is None:
            return 0
        
        cola = [self.raiz]
        max_nivel = 0
        
        while cola:
            nivel_actual = len(cola)
            max_nivel = max(max_nivel, nivel_actual)
            
            for _ in range(nivel_actual):
                nodo = cola.pop(0)
                if nodo.izquierda:
                    cola.append(nodo.izquierda)
                if nodo.derecha:
                    cola.append(nodo.derecha)
        
        return max_nivel
